# Use a build environment image as the base
FROM mybuild/download-kernel-source

ARG KERNEL_VERSION=5.10
ARG KERNEL_FILE=linux-${KERNEL_VERSION}.tar.gz
ARG BUILD_DIR=linux-${KERNEL_VERSION}

# Change to kernel source directory
WORKDIR /usr/src/${BUILD_DIR}

# Configure kernel with default configuration
RUN make defconfig

# Compile kernel
RUN make -j 12

# Set default command to boot into the new kernel
CMD ["/bin/bash"]