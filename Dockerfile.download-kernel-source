# Use a build environment image as the base
FROM mybuild/build-essentials

ARG KERNEL_VERSION
ARG KERNEL_MAJOR_VERSION
ARG KERNEL_FILE=linux-${KERNEL_VERSION}.tar.gz
ARG BUILD_DIR=linux-${KERNEL_VERSION}
ARG SRC_URL=https://cdn.kernel.org/pub/linux/kernel/v${KERNEL_MAJOR_VERSION}.x/${KERNEL_FILE}

# Download and extract kernel source
WORKDIR /usr/src

RUN wget ${SRC_URL} && \
    tar -xf ${KERNEL_FILE} && \
    rm ${KERNEL_FILE}

# Set default command to boot into the new kernel
CMD ["/bin/bash"]